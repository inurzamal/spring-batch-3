
Oracle
-------

-- Alter existing Spring Batch tables for compatibility with Spring Batch 5

-- Alter BATCH_JOB_EXECUTION table
ALTER TABLE BATCH_JOB_EXECUTION
    ADD JOB_CONFIGURATION_LOCATION VARCHAR2(2500 CHAR);

-- Alter BATCH_STEP_EXECUTION table
ALTER TABLE BATCH_STEP_EXECUTION
    ADD CREATE_TIME TIMESTAMP(6) NOT NULL DEFAULT TIMESTAMP '1970-01-01 00:00:00';

ALTER TABLE BATCH_STEP_EXECUTION
    MODIFY START_TIME TIMESTAMP(6) NULL;



-- Drop existing table
DROP TABLE MCCS_BATCH_JOB_EXECUTION_PARAMS;

-- Create new table with desired schema
CREATE TABLE MCCS_BATCH_JOB_EXECUTION_PARAMS (
    JOB_EXECUTION_ID NUMBER(19,0) NOT NULL,
    PARAMETER_NAME VARCHAR2(100) NOT NULL,
    PARAMETER_TYPE VARCHAR2(100) NOT NULL,
    PARAMETER_VALUE VARCHAR2(2500),
    IDENTIFYING CHAR(1) NOT NULL,
    CONSTRAINT JOB_EXEC_PARAMS_FK FOREIGN KEY (JOB_EXECUTION_ID) REFERENCES MCCS_BATCH_JOB_EXECUTION(JOB_EXECUTION_ID)
);


---------------------------------------------------------------------------------------

MySQL
-------

-- Alter existing Spring Batch tables for compatibility with Spring Batch 5

-- Alter BATCH_JOB_EXECUTION table
ALTER TABLE BATCH_JOB_EXECUTION
    ADD COLUMN JOB_CONFIGURATION_LOCATION VARCHAR(2500);

-- Alter BATCH_STEP_EXECUTION table
ALTER TABLE BATCH_STEP_EXECUTION
    ADD COLUMN CREATE_TIME TIMESTAMP NOT NULL DEFAULT '1970-01-01 00:00:00';

ALTER TABLE BATCH_STEP_EXECUTION
    MODIFY COLUMN START_TIME DATETIME NULL;



-- Drop existing table
DROP TABLE BATCH_JOB_EXECUTION_PARAMS;

-- Create new table with desired schema
CREATE TABLE BATCH_JOB_EXECUTION_PARAMS (
    JOB_EXECUTION_ID BIGINT NOT NULL,
    PARAMETER_NAME VARCHAR(100) NOT NULL,
    PARAMETER_TYPE VARCHAR(100) NOT NULL,
    PARAMETER_VALUE VARCHAR(2500),
    IDENTIFYING CHAR(1) NOT NULL,
    CONSTRAINT JOB_EXEC_PARAMS_FK FOREIGN KEY (JOB_EXECUTION_ID) REFERENCES BATCH_JOB_EXECUTION(JOB_EXECUTION_ID)
);


----------------------------------------------------

